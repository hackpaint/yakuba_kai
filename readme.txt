 画像掲示板(ふたば・しおから系)
futaba.php v0.8 lot.041107 Yakuba改 20190527版
----------------------------------------------------------------------------
■futaba.phpについて
このスクリプトはレッツPHP!<http://php.s3.to/>のgazou.phpを改造したものです。
配布条件はレッツPHP!に準じます。改造、再配布は自由にどうぞ。
このスクリプトに関する質問はレッツPHP!にしないようにお願いします。
最新版は<http://www.2chan.net/script/>で配布しています。
ご質問は準備板＠ふたば<http://www.2chan.net/junbi/index2.html>までどうぞ。

■Yakuba改について
このスクリプトは上記を改造したsiokara.phpをさらに改造したものです。
ご利用に際しては無保証無サポートですので、それを承知の上でご利用下さい。
改造箇所につきましてはレッツPHP様・ふたば様・しおから様へは絶対問い合わせないでください。

■設置法
スクリプトを置いたディレクトリのパーミッションを775(705)または700(701)にします。
srcなど一連のディレクトリのパーミッションを777(707)または700(701)にします。
futaba.phpを置き、ブラウザから呼出します(必要なファイルが自動設定されます)。
gif2png<http://www.tuxedo.org/~esr/gif2png/>がある場合は、
gifでもサムネイルを作れます。付属のバイナリはlinux-i386用です。

■注意
・img.logのファイル名はデフォルトから変えてご使用ください。
　define(LOGFILE, 'img.log'); // ログファイル名
・設置サーバによってはindex.htmが無いと画像掲示板設置フォルダ内が見えてしまう場合があります。
　空のindex.htmを置くか、スクリプトの入り口ファイル名指定をindex.htmに変更してください。
　define("PHP_SELF2", 'futaba.htm'); // 入り口ファイル名
・自動でディレクトリが作れない鯖がありますので、保険のために<ref><src><thumb><thumbs>を置いておきます。(Yakuba)
・既存のログなどのデータを使用する場合は鯖によって666(606)等にする必要があります。(Yakuba)

■としあき＠しおから改スクリプト
□Ver.1.0.0 2004/04/21 公開開始
futaba.php v0.8 lot.031015からの主な変更点
bmp/swfの明示的な禁止、gif表示方法改造、サムネ画質向上、スレ主強制sage機能、以下省略設定
gif2pngの入手と基本的な設置方法は上記ふたば準備板スレと配布所を参照のこと。
知恵と助言を授けてくれたとしあき達に多大なる感謝と御礼を。

□Ver.1.0.1 2004/05/09
設定可能項目に追加
文中自動リンクの可否/時間表示に秒を含めるか/メル欄にsage挿入で常時sage/設定時間後に強制sage
以下省略数指定

□Ver.1.0.2 2004/05/19
管理画面にサムネイル差し替え機能を追加/管理画面に強制スレsage化機能を追加

□Ver.1.0.3 2004/05/22
複数のサムネイル画像選択機能追加/画像の取得にhtmlを経由機能追加/投稿時にアニGIFのサムネ化選択可能に
/差し替え動作を一部修正/「レス省略」の設定値を定数化

□Ver.1.0.3a 2004/05/23
レスに画像添付可能バージョン、開発中ベータ版

□Ver.1.0.4 2004/08/01
特定のホストを登録してID(ホスト名を暗号化した文字列)、またはホスト名を表示する機能を追加

□Ver.1.0.4a 2004/08/01
レスに画像添付可能バージョンにID、ホスト名表示機能を追加
相変わらずベータ版のまま(いや、ベータ版以前に味見試験版の希ガス･･･)

□Ver.1.0.4a + α 2005/03/17
バージョンを書くと、ゴチャゴチャなっちゃう可能性があるので、書いてません。
要は、味見実験です。もっと分かり易く言えば、α版だと思え
・削除キー＼題名＼本文＼名前 必須選択
・レス時、そのスレに戻る機能追加
・スレ主が自分のスレの強制ＩＤか否か決定
・スレ主がスレ建て時に名前記入欄有無を決定
・投稿時にクッキーに保存されているものは読み込まないよう変更
・サムネイル作成ルーチンを追加
・赤くしてみるテスト。テキトーです。
・スレストを実験導入。
で、結局のところの位置付けは、α版‥？いや、β版か‥。うーん、、、人柱版かな‥？
なんてゆうか、利用者各自の判断にお任せします！　ｿｰｽがかなり汚くなっていますのでご注意を。
☆お約束☆　設置は自己責任でね！

■他力本願の役場改造スクリプト
□sc0137(Ver104a Firefox名前文字化対応 SC121base)改  by Yakuba 20090915版
・Yakuba改造部分には「Yakuba」のコメントが入っています。
・簡易認証キーを追加
・本当に簡易的なものですが、画一的な動作しかしないスパムツールには効果があるかも…
・人為的なスパム投下には効果が薄いかもしれませんが、余所者には分からないキーを付加すればスパムは減るでしょう。
・あまりにもマイナーなキーにすると新規投稿者さえ排除する事になるので注意を。
・動作がおかしかったら適度に直して下さいませ。
□Yakuba 20090921版
・アドレス末尾にスラッシュがない場合、無限アクセスに陥る場合があるバグを修正。
(ちょうど昨年にしおあき様からスクリプトの修正個所を教えていただいていましたが、これを組み込むのを忘れていました。お詫びして組み込みました。ありがとうございます。)
・cat.phpとipcount.phpを利用させていただき、カタログとカウンタを組み込みました。感謝！
□Yakuba 20100130版
・簡易認証キーを、スレ立＆レス時、またはスレ立時のみに使用できる様に変更しました。
□Yakuba 20100203版
・簡易認証キーをモード２にしてレスをすると認証キーエラーとなるミスを修正しました。
・LF改行に統一。極一部の環境で改行コードが混ざっている事でエラーが出るというご報告を頂きまして、統一させてみました。
□Yakuba 20100305版
・UNIX鯖向に文字コードを変えたら今度はWin鯖が癇癪を起こして文字化けだとか…うーん…(0303独り言)
・今更気がつきましたが、ヘッダの文字コード設定と実際の文字コードが違ってたら、そりゃ文字化けしますわな…
・と言うことで「SJIS-CRLF」に統一します。後は適当にいじってみてください。
・あとhtml4.01Transitionalへ少しシフトしてます。
□Yakuba 20101213版
・スレ立てモードの時は「スレッドを立てる」、レスモードの時は「返信する」にボタンを変更。今のふたばに近づいてます。
・あと…ほんっっとに些細なバグフィクス。
・火狐狩り系に対する文字化け対策を施しました(効果があるか分かりませんが…)。
□Yakuba 20110104版
・さらに些細なバグフィクス。あとhtml4.01Transitionalへさらにシフト。
□Yakuba 20110108版
・管理人強制sageにしていてもカキコしたら浮上するバグを修正。
□Yakuba 20110119版
・ちょっだけ改造してdel機能を搭載。
□Yakuba 20110527版
・「futaba.php v0.81 lot.070929」の消える予告時間を搭載。作者様に感謝いたします。
□Yakuba 20110904版 ＋α…
・時限強制スレスト機能を搭載。かなり乱暴かつ不親切な仕様ですので悪しからず…
・一部表示変更とバグフィクス…(20110906版)
□Yakuba 20110923版
・レス数強制スレスト機能を搭載。パンドラの匣の中のぬこ様のスクリプトをかなり参考にさせていただきました。
　この場をお借りしてお礼申し上げます。
□Yakuba 20120206版
・PHP5.3.0より「ereg」や「ereg_replace」などが非推奨となり警告を吐きまくりますので、「preg_match」や「preg_replace」へ置き換えました。
□Yakuba 20120602版
・preg系で一部警告が出まくる現象を確認しましたので、その修正をしました。
□20121120版
・PHP5.4で関数コール時に参照で引数を渡せなくなった事と、htmlspecialcharsの標準動作が変更になった事に対応(ひろ様感謝！)。□20170319版
・PHP5.6以降でとうとうデフォルトの文字コードがUTF-8になりました。
　そのため文字コードをS-JISにしてもふとした時に文字を表示させるとUTF-8で表示を仕様として文字化けしてしまいます。
　よってUTF-8化しました。
□20190527版
・クッキーで名前欄が10進法に変換されていたので修正しました。


【このスクリプトは"ふたば☆ちゃんねる"に似せているため、少しレイアウトが独自になっています】
eof
